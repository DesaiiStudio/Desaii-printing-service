<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>3D Printing Service</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: black;
      color: white;
    }
    .container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
      max-width: 900px;
      margin: auto;
    }
    .form-container {
      flex: 1;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: white;
      color: black;
    }
    .video-container {
      flex: 1;
    }
    iframe {
      width: 100%;
      height: 315px;
      border: none;
    }
    .filament-description {
      margin-top: 20px;
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 5px;
      color: black;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header img {
      max-width: 100px;
      height: auto;
    }
    .header h1 {
      font-size: 20px;
      margin: 10px 0 0;
    }
    input, select, button {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      font-size: 16px;
    }
    input[type="range"] {
      padding: 0;
    }
    .time-inputs {
      display: flex;
      gap: 10px;
    }
    .time-inputs input {
      flex: 1;
      margin: 0;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    h3 {
      color: black;
    }
    #quotation {
      margin-top: 10px;
      white-space: pre-line;
      background-color: #eef;
      padding: 10px;
      border-radius: 5px;
      color: black;
      font-size: 14px;
    }
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Video Section -->
    <div class="video-container">
      <iframe 
        src="https://www.youtube.com/embed/42GNlstzt9Y" 
        title="YouTube video player" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
        allowfullscreen>
      </iframe>
      <div id="filamentDescription" class="filament-description">
        <p>Select a filament type to see its description here.</p>
      </div>
    </div>

    <!-- Form Section -->
    <div class="form-container">
      <div class="header">
        <img src="logo.png" alt="Logo" />
        <h1>3D Printing Service</h1>
      </div>

      <label for="filament">Select Filament Type:</label>
      <select id="filament">
        <option value="PLA">PLA</option>
        <option value="PETG">PETG</option>
        <option value="ABS">ABS</option>
        <option value="PETG-CF">PETG CF</option>
      </select>

      <label for="weight">Material Weight (กรัม):</label>
      <input type="number" id="weight" placeholder="เช่น 150" min="0" max="1000" />
      <input type="range" id="weightSlider" min="0" max="1000" step="10" />

      <label>Printing Time:</label>
      <div class="time-inputs">
        <input type="number" id="hours" placeholder="ชั่วโมง" min="0"/>
        <input type="number" id="minutes" placeholder="นาที" min="0" max="59"/>
      </div>

      <h3>Total Price: <span id="price">0</span></h3>
      <div id="quotation"></div>

      <!-- Copy Quotation Button -->
      <button id="copyButton" onclick="copyQuotation()" style="background-color: #2196F3;">Copy Quotation</button>
    </div>
  </div>

  <script>
    let calculatedInfo = "";

    function calculatePrice() {
      const filamentRates = {
        PLA: { rate: 2.0, baseFee: 150 },
        PETG: { rate: 2.4, baseFee: 160 },
        ABS:  { rate: 3.0, baseFee: 180 },
        "PETG-CF": { rate: 2.8, baseFee: 175 }
      };

      const selectedFilament = document.getElementById("filament").value;
      const weight = parseFloat(document.getElementById("weight").value) || 0;
      const hours = parseFloat(document.getElementById("hours").value) || 0;
      const minutes = parseFloat(document.getElementById("minutes").value) || 0;
      const totalMinutes = hours * 60 + minutes;

      if (weight <= 0 || totalMinutes <= 0) {
        document.getElementById("price").textContent = "0";
        document.getElementById("quotation").textContent = "";
        calculatedInfo = "";
        return;
      }

      const rateInfo = filamentRates[selectedFilament];
      const materialCost = weight * rateInfo.rate;
      const printCost = (totalMinutes / 60) * 10;
      let baseFee = rateInfo.baseFee;

      // Dynamic small order fee adjustment
      if (materialCost + printCost > 600) {
        const excess = materialCost + printCost - 600;
        const reduction = Math.min((excess / 400) * baseFee, baseFee);
        baseFee -= reduction;
      }

      const totalPrice = materialCost + printCost + baseFee;
      const roundedPrice = Math.ceil(totalPrice);

      document.getElementById("price").textContent = `${roundedPrice.toLocaleString("th-TH")} ฿`;

      calculatedInfo = `Filament: ${selectedFilament}
Weight: ${weight}g
Time: ${hours}h ${minutes}m
Printing Fee: ${(materialCost + printCost).toFixed(2)} ฿
Small Order Fee: ${baseFee.toFixed(2)} ฿
Total Price: ${roundedPrice.toLocaleString("th-TH")} ฿`;

      document.getElementById("quotation").textContent = calculatedInfo;
    }

    function updateFilamentDescription() {
      const descriptions = {
        PLA: "PLA (Polylactic Acid) <br> มีจุดเสียรูปที่ความร้อนประมาณ 65°C เป็นวัสดุที่ใช้งานง่าย เหมาะสำหรับการพิมพ์ชิ้นงานทั่วไปและโมเดลตกแต่ง",
        PETG: "PETG (Polyethylene Terephthalate Glycol) <br> มีจุดเสียรูปที่ความร้อนประมาณ 80°C เหมาะสำหรับชิ้นส่วนที่ต้องการความแข็งแรง ทนต่อการใช้งานกลางแจ้ง และทนต่อสารเคมี",
        ABS: "ABS (Acrylonitrile Butadiene Styrene) <br> มีจุดเสียรูปที่ความร้อนประมาณ 90°C เหมาะสำหรับงานที่ต้องการความแข็งแรงสูงและทนต่อความร้อน",
        "PETG-CF": "PETG CF (Carbon Fiber Reinforced) is designed for higher strength, durability, and rigidity, ideal for functional prototypes and high-performance parts."
      };

      const selectedFilament = document.getElementById("filament").value;
      const description = descriptions[selectedFilament] || "Select a filament type to see its description.";
      document.getElementById("filamentDescription").innerHTML = `<p>${description}</p>`;
    }

    function copyQuotation() {
      if (calculatedInfo) {
        navigator.clipboard.writeText(calculatedInfo).then(() => {
          const toast = document.createElement("div");
          toast.textContent = "Copied!";
          toast.style.position = "fixed";
          toast.style.bottom = "20px";
          toast.style.right = "20px";
          toast.style.background = "#4CAF50";
          toast.style.color = "#fff";
          toast.style.padding = "10px 20px";
          toast.style.borderRadius = "5px";
          document.body.appendChild(toast);
          setTimeout(() => toast.remove(), 2000);
        });
      }
    }

    window.onload = function() {
      updateFilamentDescription();
      calculatePrice();

      document.getElementById("filament").addEventListener("change", () => {
        updateFilamentDescription();
        calculatePrice();
      });

      document.getElementById("weight").addEventListener("input", (e) => {
        document.getElementById("weightSlider").value = e.target.value;
        calculatePrice();
      });

      document.getElementById("weightSlider").addEventListener("input", (e) => {
        document.getElementById("weight").value = e.target.value;
        calculatePrice();
      });

      document.getElementById("hours").addEventListener("input", calculatePrice);
      document.getElementById("minutes").addEventListener("input", calculatePrice);
    };
  </script>
</body>
</html>
